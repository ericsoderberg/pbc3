<%= content_tag_for(:li, fill_form_field,
  :class => "#{fill_form_field.field_type}") do %>
  <% filled_field = @filled_form.filled_fields.detect{|ff|
      fill_form_field == ff.form_field}
    value = filled_field ? filled_field.value : ''
    html_id = "filled_fields[#{fill_form_field.id}][value]" -%>
  
  <div class="form_field_name">
    <%= fill_form_field.name %>
  </div>
  
  <div class="form_field_value">
  <% case fill_form_field.field_type -%>
    <% when FormField::FIELD -%>
      <%= text_field_tag html_id, value, :size => fill_form_field.size %>
    <% when FormField::AREA -%>
      <%= text_area_tag html_id, value, :size => fill_form_field.size %>
    <% when FormField::SINGLE_CHOICE -%>
      <ul class="options_list">
        <% fill_form_field.form_field_options.each do |option| -%>
          <li>
            <%= radio_button_tag html_id, option.name,
              (value == option.name) %>
            <div class="option_name">
              <%= option.name %>
            </div>
            <div class="option_help">
              <%= raw option.help %>
            </div>
          </li>
        <% end -%>
      </ul>
    <% when FormField::MULTIPLE_CHOICE -%>
      <ul class="options_list">
        <% fill_form_field.form_field_options.each do |option| -%>
          <li>
            <%= check_box_tag html_id+'[]', option.name,
              value.split(',').include?(option.name) %>
            <div class="option_name">
              <%= option.name %>
            </div>
            <div class="option_help">
              <%= raw option.help %>
            </div>
          </li>
        <% end -%>
      </ul>
    <% when FormField::INSTRUCTIONS -%>
  <% end -%>
  
  <div class="form_field_help">
    <%= raw fill_form_field.help %>
  </div>
  </div>
<% end %>
